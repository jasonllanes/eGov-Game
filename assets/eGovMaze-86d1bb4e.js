import{u as H,r as f,j as t}from"./index-4be1f7bd.js";import{B as N}from"./button-e341fd11.js";const j=21,y=31;function U(){const d=[];for(let c=0;c<j;c++){const u=[];for(let o=0;o<y;o++)u.push("wall");d.push(u)}return d}function X(d){const c=[...d];for(let u=c.length-1;u>0;u--){const o=Math.floor(Math.random()*(u+1));[c[u],c[o]]=[c[o],c[u]]}return c}function E(){const d=U(),c=(r,l)=>r>0&&r<j-1&&l>0&&l<y-1,u=(r,l)=>{d[r][l]="path";const p=X([{row:-2,col:0},{row:2,col:0},{row:0,col:-2},{row:0,col:2}]);for(const z of p){const w=r+z.row,x=l+z.col;c(w,x)&&d[w][x]==="wall"&&(d[r+z.row/2][l+z.col/2]="path",u(w,x))}},o={row:1,col:1};u(o.row,o.col);let C=o,M=-1;for(let r=0;r<j;r++)for(let l=0;l<y;l++)if(d[r][l]==="path"){const p=Math.abs(r-o.row)+Math.abs(l-o.col);p>M&&(M=p,C={row:r,col:l})}return d[o.row][o.col]="start",d[C.row][C.col]="end",{grid:d,start:o,end:C}}const J=()=>{const d=H(),[{grid:c,start:u,end:o},C]=f.useState(()=>E()),[M,r]=f.useState(18),[l,p]=f.useState(1),[z,w]=f.useState(!1),[x,G]=f.useState("playing"),[L,T]=f.useState(!1),S=f.useRef(null),g=f.useRef(null),P=f.useRef(null),m=M*l;f.useEffect(()=>{const e=()=>{const n=window.innerWidth;n<480?r(14):n<768?r(16):n<1024?r(20):r(22)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),f.useEffect(()=>{const e=S.current;if(e){e.width=y*m,e.height=j*m;const n=e.getContext("2d");n&&n.clearRect(0,0,e.width,e.height)}g.current=null},[M,l,c]);const b=()=>{d("/eGov-Game/main-page")},D=()=>{const e=E();C(e),w(!1),G("playing"),T(!1);const n=S.current;if(n){const a=n.getContext("2d");a&&a.clearRect(0,0,n.width,n.height)}g.current=null,P.current=null},W=(e,n,a,h)=>{if(x==="playing"){if(L){const s=g.current;if(!s)return;const i=a-s.x,R=h-s.y;if(Math.hypot(i,R)>m*.85)return}else{if(e!==u.row||n!==u.col)return;T(!0);const s=S.current;if(s){const i=s.getContext("2d");i&&i.clearRect(0,0,s.width,s.height)}}g.current={x:a,y:h},P.current={r:e,c:n},w(!0)}},Y=(e,n,a,h)=>{if(!z||x!=="playing")return;const s=c[e][n],i=S.current,R=P.current;if(R&&R.r===e&&R.c===n)return;P.current={r:e,c:n};const k=g.current;if(i&&k){const v=i.getContext("2d");v&&(v.strokeStyle="#22c55e",v.lineWidth=2,v.lineCap="round",v.beginPath(),v.moveTo(k.x,k.y),v.lineTo(a,h),v.stroke(),g.current={x:a,y:h})}else i&&!k&&(g.current={x:a,y:h});if(s==="wall"){w(!1),G("lost");return}e===o.row&&n===o.col&&(w(!1),G("won"))},A=()=>{w(!1)},F=e=>{if(x!=="playing")return;e.preventDefault();const n=e.currentTarget.getBoundingClientRect(),a=e.clientX-n.left,h=e.clientY-n.top,s=Math.floor(a/m),i=Math.floor(h/m);if(!(i<0||i>=j||s<0||s>=y)){try{e.currentTarget.setPointerCapture(e.pointerId)}catch{}W(i,s,a,h)}},I=e=>{if(!z||x!=="playing")return;e.preventDefault();const n=e.currentTarget.getBoundingClientRect(),a=e.clientX-n.left,h=e.clientY-n.top,s=Math.floor(a/m),i=Math.floor(h/m);i<0||i>=j||s<0||s>=y||Y(i,s,a,h)},B=e=>{A();try{e.currentTarget.releasePointerCapture(e.pointerId)}catch{}},O=f.useMemo(()=>c.map((e,n)=>t.jsx("div",{className:"maze-row",children:e.map((a,h)=>{let s="maze-cell";return a==="wall"&&(s+=" maze-cell-wall"),a==="path"&&(s+=" maze-cell-path"),a==="start"&&(s+=" maze-cell-start"),a==="end"&&(s+=" maze-cell-end"),t.jsx("div",{className:s,style:{width:m,height:m}},h)})},n)),[c,M]);return t.jsxs("div",{className:"maze-page",children:[t.jsxs("div",{className:"maze-header",children:[t.jsx("h1",{className:"maze-title",children:"Game 5: eGov Maze"}),t.jsx("p",{className:"maze-subtitle",children:"Level 1: Hold and draw a path from START to END without touching the walls. Works with mouse or touch."})]}),t.jsxs("div",{className:"maze-controls",children:[t.jsx(N,{text:"Back to Game Select",onClick:b}),t.jsx(N,{text:"New Random Maze",onClick:D}),t.jsxs("div",{className:"maze-zoom-controls",children:[t.jsx("button",{type:"button",className:"maze-zoom-btn",onClick:()=>p(e=>Math.max(.5,+(e-.25).toFixed(2))),children:"âˆ’"}),t.jsxs("span",{className:"maze-zoom-label",children:[Math.round(l*100),"%"]}),t.jsx("button",{type:"button",className:"maze-zoom-btn",onClick:()=>p(e=>Math.min(2,+(e+.25).toFixed(2))),children:"+"})]})]}),t.jsx("div",{className:"maze-viewport",children:t.jsxs("div",{className:"maze-container",onPointerDown:F,onPointerMove:I,onPointerUp:B,onPointerCancel:B,style:{width:y*m,height:j*m},children:[O,t.jsx("canvas",{ref:S,className:"maze-canvas"})]})}),x==="won"&&t.jsx("div",{className:"maze-overlay",children:t.jsxs("div",{className:"maze-overlay-card",children:[t.jsx("h2",{children:"Congratulations!"}),t.jsx("p",{children:"You conquered the eGov Maze Level 1."}),t.jsxs("div",{className:"maze-overlay-actions",children:[t.jsx(N,{text:"Play Again (New Maze)",onClick:D}),t.jsx(N,{text:"Back to Game Select",onClick:b})]})]})}),x==="lost"&&t.jsx("div",{className:"maze-overlay",children:t.jsxs("div",{className:"maze-overlay-card",children:[t.jsx("h2",{children:"Game Over"}),t.jsx("p",{children:"You hit a wall while drawing the path."}),t.jsxs("div",{className:"maze-overlay-actions",children:[t.jsx(N,{text:"Try Again (New Maze)",onClick:D}),t.jsx(N,{text:"Back to Game Select",onClick:b})]})]})})]})};export{J as default};
